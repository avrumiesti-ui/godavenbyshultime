<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GoDavenByShulTime</title>
    <style>
        /* --- THE LOOK & COLORS --- */
        :root {
            --primary: #1a365d; /* Deep Blue */
            --accent: #d4af37;  /* Gold */
            --bg: #f4f7f9;
            --text: #333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding-top: 130px; /* This maintains the "Recent Heights" sticky space */
            color: var(--text);
        }

        /* --- STICKY HEADER --- */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            background: var(--primary);
            color: white;
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            z-index: 1000;
        }

        .header-wrap { max-width: 600px; margin: 0 auto; padding: 0 20px; }
        
        h1 { margin: 0 0 10px 0; font-size: 1.4rem; color: var(--accent); letter-spacing: 1px; }

        input#search {
            width: 100%;
            padding: 12px;
            border-radius: 25px;
            border: none;
            outline: none;
            font-size: 1rem;
        }

        /* --- SHUL CARDS --- */
        .container { max-width: 600px; margin: 0 auto; padding: 15px; }

        .shul-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 8px solid var(--accent);
            position: relative;
        }

        .shul-name { font-size: 1.3rem; font-weight: bold; color: var(--primary); margin-bottom: 5px; }
        .shul-detail { margin: 5px 0; font-size: 0.95rem; display: flex; align-items: center; }
        .icon { margin-right: 10px; width: 20px; text-align: center; }

        /* --- SAVES (FAVORITES) --- */
        .save-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.3;
            transition: 0.3s;
        }
        .save-btn.active { opacity: 1; filter: drop-shadow(0 0 2px gold); }

        .loading-msg { text-align: center; margin-top: 50px; font-weight: bold; color: var(--primary); }
    </style>
</head>
<body>

<header>
    <div class="header-wrap">
        <h1>GoDavenByShulTime</h1>
        <input type="text" id="search" placeholder="üîç Search Shul, Rabbi, or Nusach..." onkeyup="filterShuls()">
    </div>
</header>

<div class="container" id="list-container">
    <div class="loading-msg" id="status">Connecting to Database...</div>
</div>

<script>
    let shuls = [];
    let saved = JSON.parse(localStorage.getItem('myShuls')) || [];

    // THE MAGIC: This pulls directly from your GitHub Raw link to bypass local blocks
    const DATA_URL = 'https://raw.githubusercontent.com/avrumiesti-ui/godavenbyshultime/main/database.json';

    async function loadData() {
        const status = document.getElementById('status');
        try {
            const response = await fetch(DATA_URL);
            if (!response.ok) throw new Error("Could not pull data");
            
            shuls = await response.json();
            status.style.display = 'none';
            displayShuls(shuls);
        } catch (err) {
            status.innerHTML = "‚ùå Error loading data. Please refresh.";
            console.error(err);
        }
    }

    function displayShuls(data) {
        const container = document.getElementById('list-container');
        container.innerHTML = data.map(shul => {
            const isSaved = saved.includes(shul.name);
            return `
                <div class="shul-card">
                    <button class="save-btn ${isSaved ? 'active' : ''}" onclick="toggleSave('${shul.name}')">‚≠ê</button>
                    <div class="shul-name">${shul.name}</div>
                    <div class="shul-detail"><span class="icon">üìç</span> ${shul.address}</div>
                    <div class="shul-detail"><span class="icon">üë≥</span> Rabbi: ${shul.rabbi}</div>
                    <div class="shul-detail"><span class="icon">üìñ</span> Nusach: ${shul.nusach}</div>
                </div>
            `;
        }).join('');
    }

    function filterShuls() {
        const term = document.getElementById('search').value.toLowerCase();
        const filtered = shuls.filter(s => 
            s.name.toLowerCase().includes(term) || 
            s.rabbi.toLowerCase().includes(term) || 
            s.nusach.toLowerCase().includes(term)
        );
        displayShuls(filtered);
    }

    function toggleSave(name) {
        if (saved.includes(name)) {
            saved = saved.filter(item => item !== name);
        } else {
            saved.push(name);
        }
        localStorage.setItem('myShuls', JSON.stringify(saved));
        displayShuls(shuls); // Refresh icons
    }

    window.onload = loadData;
</script>

</body>
</html>
